"use strict";(self["webpackChunkdrchat"]=self["webpackChunkdrchat"]||[]).push([[770],{8770:function(e,t,s){s.r(t),s.d(t,{default:function(){return Ie}});s(7658);var i=s(3396),o=s(7139);const a=e=>((0,i.dD)("data-v-7ec9ce7e"),e=e(),(0,i.Cn)(),e),n={key:0,class:"message-box"},l={class:"message-head"},r={class:"contact"},c=a((()=>(0,i._)("div",{class:"iconfont icon-shang turn-up"},null,-1))),d=a((()=>(0,i._)("div",{class:"text"},"106条新消息",-1))),g=a((()=>(0,i._)("div",{class:"iconfont icon-chaguanbi close"},null,-1))),u=[c,d,g];function h(e,t,s,a,c,d){const g=(0,i.up)("a-button"),h=(0,i.up)("a-spin"),m=(0,i.up)("Message"),v=(0,i.up)("SendBox"),p=(0,i.up)("Members");return e.conversationId?((0,i.wg)(),(0,i.iD)("div",n,[(0,i._)("div",l,[(0,i._)("div",r,[e.isMobile()?((0,i.wg)(),(0,i.iD)("i",{key:0,class:"iconfont icon-zuojiantou goback",onClick:t[0]||(t[0]=t=>e.$router.go(-1))})):((0,i.wg)(),(0,i.j4)(g,{key:1,type:"text",size:"small",style:{float:"left"},onClick:t[1]||(t[1]=t=>e.$router.push("/message"))},{default:(0,i.w5)((()=>[(0,i.Uk)("返回")])),_:1})),(0,i.Uk)(" "+(0,o.zw)(e.conversation.object_info?.title)+" ",1),2==e.conversation.object_type?((0,i.wg)(),(0,i.iD)("i",{key:2,class:"iconfont icon-gengduo menu-more",onClick:t[2]||(t[2]=t=>e.showGroupMembers=!0)})):(0,i.kq)("",!0)])]),(0,i._)("div",{class:"message-content",ref:"messageContentBox",onScroll:t[5]||(t[5]=(...t)=>e.scrollit&&e.scrollit(...t))},[(0,i.Wm)(h,{spinning:e.app.loading},null,8,["spinning"]),e.app.has_more?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"load-more",onClick:t[3]||(t[3]=(...t)=>e.loadMoreMessage&&e.loadMoreMessage(...t))},"查看更多消息")):(0,i.kq)("",!0),e.app.has_new?((0,i.wg)(),(0,i.iD)("div",{key:1,class:"load-new",onClick:t[4]||(t[4]=(...t)=>e.loadNewMessage&&e.loadNewMessage(...t))},u)):(0,i.kq)("",!0),((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(e.messageRecords,((t,s)=>((0,i.wg)(),(0,i.j4)(m,{key:s,ref_for:!0,ref:s=>e.refs[t.id]=s,data:t,type:t.direction,onOnRedDot:e.handleRedDot},null,8,["data","type","onOnRedDot"])))),128))],544),(0,i.Wm)(v,{ref:"sendBox",video:1==e.conversation.object_type,onSend:e.handleSend,onVchat:e.handleVideoChat},null,8,["video","onSend","onVchat"]),2==e.conversation.object_type?((0,i.wg)(),(0,i.j4)(p,{key:0,modelValue:e.showGroupMembers,"onUpdate:modelValue":t[6]||(t[6]=t=>e.showGroupMembers=t),"group-id":e.conversation.object_id,"group-name":e.conversation.object_info.title},null,8,["modelValue","group-id","group-name"])):(0,i.kq)("",!0)])):(0,i.kq)("",!0)}var m=s(5818),v=s(2482),p=s(4870),C=s(9242),A=s(3641);const R={class:"avatar"},E=["src"],I={key:0,class:"message-ep"},Q={class:"message"},w=["innerHTML"];var k=(0,i.aZ)({__name:"Message",props:{data:Object,type:String},emits:["onRedDot"],setup(e,{expose:t,emit:s}){const a=e=>{s("onRedDot",e)},n=(0,p.iH)();return t({messageItem:n}),(t,s)=>((0,i.wg)(),(0,i.iD)("div",{class:(0,o.C_)(e.type),ref_key:"messageItem",ref:n},[(0,i._)("div",R,[(0,i._)("img",{src:e.data.avatar},null,8,E)]),e.data.datetime?((0,i.wg)(),(0,i.iD)("div",I,(0,o.zw)(e.data.datetime),1)):(0,i.kq)("",!0),(0,i._)("div",Q,[(0,i._)("span",{innerHTML:(0,p.SU)(A.du)(e.data.content)},null,8,w),e.data.red_dot?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"red-dot",onClick:s[0]||(s[0]=(0,C.iM)((t=>a(e.data)),["stop"]))})):(0,i.kq)("",!0)])],2))}}),M=s(89);const f=(0,M.Z)(k,[["__scopeId","data-v-f21fe6f2"]]);var y=f,b="data:image/png;base64,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",x="data:image/png;base64,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",B=s(65);const U=e=>((0,i.dD)("data-v-05eefdcb"),e=e(),(0,i.Cn)(),e),D={class:"send-tool"},S={key:0,class:"emoji-box"},j={class:"emoji-body"},Z=["onClick"],H=["src","title"],Y=U((()=>(0,i._)("img",{src:b},null,-1))),z=[Y],K=U((()=>(0,i._)("img",{src:x},null,-1))),q=[K],G=U((()=>(0,i._)("i",{class:"iconfont icon-xiaolian"},null,-1))),J=[G],V=(0,i.uE)('<div class="tool-item" data-v-05eefdcb><i class="iconfont icon-folder" data-v-05eefdcb></i></div><div class="tool-item" data-v-05eefdcb><i class="iconfont icon-jiandao" data-v-05eefdcb></i></div><div class="tool-item" data-v-05eefdcb><i class="iconfont icon-liaotianjilu" data-v-05eefdcb></i></div>',3),L={class:"the-right"},O=U((()=>(0,i._)("div",{class:"tool-item"},[(0,i._)("i",{class:"iconfont icon-tongxinyuan"})],-1))),N=U((()=>(0,i._)("i",{class:"iconfont icon-shipindianhua1"},null,-1))),P=[N],W=["onKeydown","onKeyup"];var T=(0,i.aZ)({__name:"SendBox",props:{video:{type:Boolean,default:!0}},emits:["vchat","send"],setup(e,{expose:t,emit:s}){const o=(0,B.oR)(),a=(0,p.iH)(null),n=(0,p.iH)(null);(0,i.bv)((()=>{}));let l=(0,p.iH)(null),r=(0,p.iH)(!1),c=(0,p.qj)({bgContext:""});(0,i.Fl)((()=>o.state.Chat.expressions));const d=(0,i.Fl)((()=>o.state.Chat.expressions));let g=(0,i.Fl)((()=>window.getSelection()));const u={mounted:(e,t,s,i)=>{e.__vueClickOutside__=function(s){for(var i=0;i<=3;i++){var o=s.path[i];if(!o)break;if(-1!==o.className.search(/(emoji-box|emoji-body|emoji-item)/is))return!1}if(e.contains(s.target))return!1;t.value&&t.value(s)},document.addEventListener("click",e.__vueClickOutside__)},unmounted(e,t,s,i){document.removeEventListener("click",e.__vueClickOutside__),delete e.__vueClickOutside__}},h=e=>{b(),l.value&&(g.value.removeAllRanges(),g.value.addRange(l.value)),document.execCommand("insertHTML",!1,`<img emoji-name="${e.code}" class="editor-emoji" src="${e.path}"/>`),I()},m=e=>{console.log(e)},v=()=>{I()},A=()=>{r.value=!r.value,r.value&&!d.value.length&&o.dispatch("Chat/refreshExpressions",!0)},R=()=>{r.value=!1},E=()=>{s("vchat")},I=()=>{l.value=g.value.getRangeAt(0)},Q=()=>{c.bgContext=a.value.style.backgroundColor,a.value.style.backgroundColor="#FFFFFF"},w=()=>{a.value.style.backgroundColor=c.bgContext},k=()=>{let e=n.value.innerHTML;return M(e)},M=e=>e.replace(/<img emoji-name=["|']([^"]*?)["|'] [^>]*>/gi,"[!$1]"),f=()=>{var e=k();e||console.log("内容为空"),s("send",e)},y=()=>{n.value&&(n.value.innerHTML="")},b=()=>{n.value&&n.value.focus()};return t({clear:y,focus:b}),(t,s)=>((0,i.wg)(),(0,i.iD)("div",{class:"send-box",ref_key:"sendBoxRef",ref:a},[(0,i._)("div",D,[(0,p.SU)(r)?((0,i.wg)(),(0,i.iD)("div",S,[(0,i._)("div",j,[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)((0,p.SU)(d),((e,t)=>((0,i.wg)(),(0,i.iD)("div",{key:t,class:"emoji-item",onClick:t=>h(e)},[(0,i._)("img",{src:e.path,title:e.name},null,8,H)],8,Z)))),128))]),(0,i._)("div",{class:"emoji-foot"},[(0,i._)("div",{class:"emoji-cate act",onClick:m},z),(0,i._)("div",{class:"emoji-cate",onClick:m},q)])])):(0,i.kq)("",!0),(0,i.wy)(((0,i.wg)(),(0,i.iD)("div",{class:"tool-item",onClick:A},J)),[[u,R]]),V,(0,i._)("div",L,[O,e.video?((0,i.wg)(),(0,i.iD)("div",{key:0,class:"tool-item",onClick:E},P)):(0,i.kq)("",!0)])]),(0,i._)("div",{class:"message-textarea",contenteditable:"true",spellcheck:"false",ref_key:"messageTextareaRef",ref:n,onFocus:Q,onBlur:w,onKeydown:[(0,C.D2)((0,C.iM)(f,["ctrl"]),["enter"]),(0,C.iM)(v,["exact"])],onClick:v,onKeyup:(0,C.iM)(v,["exact"])},null,40,W),(0,i._)("div",{class:"send-foot"},[(0,i._)("button",{class:"send-btn",type:"button",onClick:f},"发送(S)")])],512))}});const F=(0,M.Z)(T,[["__scopeId","data-v-05eefdcb"]]);var X=F,_=s(4022),$=s(3495),ee=s(2074),te=s(2483);const se=e=>((0,i.dD)("data-v-6fe32907"),e=e(),(0,i.Cn)(),e),ie={class:"avatar"},oe=["src"],ae={class:"nickname"},ne={class:"card-item"},le={class:"item-content"},re=se((()=>(0,i._)("div",{class:"card-item"},"群二维码",-1))),ce=se((()=>(0,i._)("div",{class:"card-item"},"群公告",-1))),de=se((()=>(0,i._)("div",{class:"card-item"},"备注",-1)));var ge=(0,i.aZ)({__name:"Members",props:{modelValue:Boolean,groupId:{type:Number,required:!0},groupName:{type:String,required:!0}},emits:["update:modelValue"],setup(e,{emit:t}){const s=e,a=(0,te.tv)(),n=(0,B.oR)();let l=(0,p.iH)((0,A.tq)()?"80%":"420px");(0,i.bv)((()=>{}));let r=(0,p.iH)([]);(0,i.YP)((()=>s.modelValue),(e=>{e&&_.C.loading(!0).members(s.groupId).then((e=>r.value=e.data))}));const c=()=>{t("update:modelValue",!1)},d=()=>{$.Z.confirm({title:"退出群聊",content:"确定退出当前群聊？",okText:"确定",cancelText:"再想想",onOk:()=>_.C.exit(s.groupId).then((e=>{ee.ZP.success(e.message),t("update:modelValue",!1),n.dispatch("Conversation/refreshConversationList"),n.dispatch("Contact/refreshGroupList"),a.push("/message")}))})};return(t,s)=>{const a=(0,i.up)("a-card"),n=(0,i.up)("a-drawer");return(0,i.wg)(),(0,i.j4)(n,{title:"群成员",width:(0,p.SU)(l),visible:e.modelValue,"body-style":{padding:0},"drawer-style":{backgroundColor:"#f5f5f5"},"header-style":{backgroundColor:"#f5f5f5"},placement:"right",onClose:c},{default:(0,i.w5)((()=>[(0,i.Wm)(a,{class:"card","body-style":{padding:0}},{default:(0,i.w5)((()=>[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)((0,p.SU)(r),((e,t)=>((0,i.wg)(),(0,i.iD)("div",{class:"member",key:t},[(0,i._)("div",ie,[(0,i._)("img",{src:e.user_info.avatar},null,8,oe)]),(0,i._)("div",ae,(0,o.zw)(e.user_info.nickname),1)])))),128))])),_:1}),(0,i.Wm)(a,{class:"card","body-style":{padding:0}},{default:(0,i.w5)((()=>[(0,i._)("div",ne,[(0,i.Uk)(" 群聊名称 "),(0,i._)("div",le,(0,o.zw)(e.groupName),1)]),re,ce,de])),_:1}),(0,i.Wm)(a,{class:"card","body-style":{padding:0}},{default:(0,i.w5)((()=>[(0,i._)("div",{class:"card-item exit",onClick:d},"删除并退出")])),_:1})])),_:1},8,["width","visible"])}}});const ue=(0,M.Z)(ge,[["__scopeId","data-v-6fe32907"]]);var he=ue,me=s(5599),ve=s(1064),pe=s(504),Ce=s(4152);class Ae{constructor(){(0,v.Z)(this,"socketio",void 0),(0,v.Z)(this,"store",void 0),(0,v.Z)(this,"router",void 0),(0,v.Z)(this,"route",void 0),(0,v.Z)(this,"messageRecords",void 0),(0,v.Z)(this,"conversation",void 0),(0,v.Z)(this,"conversationId",(0,p.iH)(0)),(0,v.Z)(this,"lastScrollHeight",void 0),(0,v.Z)(this,"sendBox",(0,p.iH)()),(0,v.Z)(this,"messageContentBox",(0,p.iH)()),(0,v.Z)(this,"app",void 0),(0,v.Z)(this,"components",{CloseOutlined:me.Z,SendBox:X,Message:y,Members:he})}setup(e,t){return this.socketio=(0,ve.Jy)(),this.store=(0,B.oR)(),this.router=(0,te.tv)(),this.route=(0,te.yj)(),this.messageRecords=(0,p.iH)([]),this.conversation=(0,p.iH)({}),this.app=(0,p.qj)({page:1,has_more:!0,has_new:!1,loading:!1,initializing:!1,sending_message:!1}),this.lastScrollHeight=(0,p.iH)(0),(0,i.YP)((()=>this.route.query.conversation_id),(e=>this.initData())),(0,i.bv)(this.mounted.bind(this)),{app:this.app,refs:(0,p.iH)([]),messageRecords:this.messageRecords,conversationId:this.conversationId,conversation:this.conversation,isMobile:A.tq,sendBox:this.sendBox,messageContentBox:this.messageContentBox,showGroupMembers:(0,p.iH)(!1),handleSend:(0,A.P2)(this.handleSend.bind(this)),handleVideoChat:(0,A.P2)(this.handleVideoChat.bind(this)),handleRedDot:(0,A.P2)(this.handleRedDot.bind(this)),scrollit:this.scrollit.bind(this),loadNewMessage:(0,A.P2)(this.loadNewMessage.bind(this)),loadMoreMessage:this.loadMoreMessage.bind(this)}}initData(){this.conversationId.value=this.route.query.conversation_id,this.app.page=1,this.app.has_more=!0,this.messageRecords.value=[],this.conversation.value={},(0,p.SU)(this.conversationId)&&(this.app.initializing=!0,this.loadMessage(this.app.page).then((e=>{this.messageRecords.value=e?.data?.list,(0,i.Y3)((()=>{this.scrollBottom(),this.updateScrollHeight(),this.app.initializing=!1}))})))}mounted(){this.conversationId.value=this.route.query.conversation_id,this.conversationId.value&&this.initData(),this.socketio.off("chat_new_message").on("chat_new_message",(e=>{if(!this.conversationId.value||this.conversation.value.object_id!=e.receiver&&e.scene==Ce.Z.CONVERSATION_GROUP||e.sender==this.store.state.User.info.id)return;this.messageRecords.value.push({avatar:e.sender_info?.avatar,content:e.content,direction:"forward"}),this.isBrowsing()||(0,i.Y3)((()=>this.scrollBottom()));const t=this.conversation.value.object_type==Ce.Z.CONVERSATION_GROUP;Ce.Z.clearUnread(t?this.conversation.value.object_id:e.sender,t)}))}handleVideoChat(){this.conversation.value.object_type==Ce.Z.CONVERSATION_NORMAL&&this.router.push({name:"video-chat",query:{friend_id:this.conversation.value.object_id}})}sendMessage(e){if(this.app.sending_message)return ee.ZP.warn("上一条消息正在发送"),Promise.resolve();this.app.sending_message=!0,this.sendBox.value&&(0,p.SU)(this.sendBox).clear();let t=(0,p.SU)(this.conversation).object_type==Ce.Z.CONVERSATION_GROUP;return pe.Z.loading(!0).send((0,p.SU)(this.conversation).object_id,e,t).then((e=>{this.store.dispatch("Conversation/refreshConversationList"),ee.ZP.success(e.message)})).finally((()=>this.app.sending_message=!1))}handleSend(e){if(this.app.initializing)return ee.ZP.warn("等待数据加载完成"),!1;if(!e)return ee.ZP.error("内容不能为空"),!1;let t=(0,p.qj)({content:e,avatar:this.store.state.User.info.avatar,red_dot:!1,direction:"reverse",sender:this.store.state.User.info.id,receiver:this.conversation.value.object_id,id:(new Date).getTime()});this.messageRecords.value.push(t),this.sendMessage(e).catch((()=>t.red_dot=!0)),(0,i.Y3)((()=>this.scrollBottom()))}handleRedDot(e){$.Z.confirm({content:"重新发送消息?",okText:"确认",cancelText:"取消",onOk:(0,A.P2)((()=>{this.sendMessage(e.content).then((()=>{this.messageRecords.value=(0,p.SU)(this.messageRecords).map((t=>{let s=t.red_dot;return t.id===e.id&&(s=!1),{...t,red_dot:s}}))}))}))})}loadMessage(e,t=30){return this.app.loading?Promise.resolve():(this.app.loading=!0,pe.Z.loading().records((0,p.SU)(this.conversationId),e,t).then((e=>(this.conversation.value=e.data.conversation,e.data.list.length||(this.app.has_more=!1),e.data.list=e.data.list.map((e=>({...e,avatar:e.sender_info.avatar,realname:e.sender_info.realname,content:e.record.content}))),this.store.dispatch("Conversation/refreshConversationList"),Promise.resolve(e)))).finally((()=>this.app.loading=!1)))}loadNewMessage(){}loadMoreMessage(){this.loadMessage(++this.app.page).then((e=>{this.messageRecords.value=[...e.data.list,...(0,p.SU)(this.messageRecords)],(0,i.Y3)((()=>{let e=this.lastScrollHeight.value;this.updateScrollHeight();let t=this.lastScrollHeight.value,s=t-e;s>30&&this.scrollTo(s-30)}))}),(()=>this.app.page--)).catch((()=>this.app.page--))}scrollit(e){0==e.target.scrollTop&&this.app.has_more&&this.loadMoreMessage()}isBrowsing(){if(!this.messageContentBox.value)return!1;const e=this.messageContentBox.value.scrollTop,t=this.messageContentBox.value.scrollHeight,s=this.messageContentBox.value.offsetHeight,i=t-s;return e<i-s/2}scrollBottom(){if(!this.messageContentBox.value)return!1;this.scrollTo(this.messageContentBox.value.scrollHeight)}scrollTo(e){if(!this.messageContentBox.value)return!1;this.messageContentBox.value.scrollTop=e}updateScrollHeight(){if(!this.messageContentBox.value)return!1;this.lastScrollHeight.value=this.messageContentBox.value.scrollHeight}}var Re=(0,m.Z)(new Ae);const Ee=(0,M.Z)(Re,[["render",h],["__scopeId","data-v-7ec9ce7e"]]);var Ie=Ee}}]);
//# sourceMappingURL=770.22347210.js.map